<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تعقيبات الصلاة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
        
        body {
            font-family: 'Tajawal', sans-serif;
            transition: background-color 0.5s, color 0.5s;
            background-attachment: fixed;
            /* === إضافة متغير CSS للتحكم بحجم الخط === */
            --supplication-font-size: 1.15rem; 
        }

        /* --- الوضع الفاتح --- */
        .light-mode {
            background-color: #e0e0e0;
        }
        .light-mode .app-container { background-color: #f4f1ea; }
        .light-mode .main-title { color: #2d6a4f; }
        .light-mode .section-title { color: #4a4a4a; }
        .light-mode .prayer-card { 
            background-color: #ffffff; 
            border: 1px solid #e0e0e0; /* إضافة حد خفيف */
        }
        .light-mode .prayer-card h3 { color: #1f1f1f; }
        .light-mode .supplication-text { 
            color: #000000; 
            font-weight: 500; 
        }
        .light-mode .tasbeeh-phrase { color: #2d6a4f; }
        .light-mode .tasbeeh-counter-bg { 
            background-image: linear-gradient(145deg, #e6f3ee, #ffffff); 
        }
        .light-mode .tasbeeh-counter-text { color: #2d6a4f; }
        .light-mode .tasbeeh-reset-btn { 
            background-color: #e9e9e9; 
            color: #555; 
        }
        .light-mode .main-tab-btn {
            box-shadow: 0 4px 10px rgba(45, 106, 79, 0.4);
        }
        /* --- أدوات التحكم (Control Toolbar) --- */
        .light-mode .control-toolbar { background-color: #f0f0f0; border-bottom: 1px solid #ddd; }
        .light-mode .control-toolbar button { background-color: #e0e0e0; color: #333; }
        .light-mode .control-toolbar button:hover { background-color: #d0d0d0; }

        /* --- الوضع الداكن --- */
        .dark-mode {
            background-color: #121212;
        }
        .dark-mode .app-container { background-color: #191919; }
        .dark-mode .main-title { color: #6ee7b7; }
        .dark-mode .section-title { color: #e0f2f1; }
        .dark-mode .prayer-card { background-color: #2a2a2a; border: 1px solid #3a3a3a; }
        .dark-mode .prayer-card h3 { color: #ffffff; }
        .dark-mode .supplication-text { 
            color: #b2f5ea; 
            font-weight: 400;
        }
        .dark-mode .tasbeeh-phrase { color: #6ee7b7; }
        .dark-mode .tasbeeh-counter-bg { background-image: linear-gradient(145deg, #2a2a2a, #1f1f1f); }
        .dark-mode .tasbeeh-counter-text { color: #6ee7b7; }
        .dark-mode .tasbeeh-reset-btn { background-color: #3a3a3a; color: #c0c0c0; }
        .dark-mode .main-tab-btn {
             background-color: #58a67d!important; /* Override inline style */
             box-shadow: 0 4px 10px rgba(110, 231, 183, 0.2);
        }
        .dark-mode #darkModeToggle {
            background-color: #00000050;
        }
        .dark-mode .bg-gray-300 {
            background-color: #3f3f46;
            color: #d4d4d8;
        }
         /* --- أدوات التحكم (Control Toolbar) --- */
        .dark-mode .control-toolbar { background-color: #3a3a3a; border-bottom: 1px solid #4a4a4a; }
        .dark-mode .control-toolbar button { background-color: #2a2a2a; color: #c0c0c0; }
        .dark-mode .control-toolbar button:hover { background-color: #1f1f1f; }

        .app-container {
            max-width: 450px;
            margin: 0 auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            min-height: 100vh;
        }

        .prayer-card {
            border-radius: 1.25rem;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.07);
            /* لضبط الطباعة: إزالة الظل والحدود في وضع الطباعة */
            /* @media print {
                box-shadow: none;
                border: none;
            } */
        }
        
        .tasbeeh-btn {
            transition: all 0.2s ease;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            min-height: 150px;
        }
        .tasbeeh-btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        
        .supplication-text {
            /* === استخدام متغير CSS لحجم الخط === */
            font-size: var(--supplication-font-size);
            line-height: 2;
            padding-top: 0.5rem;
            transition: color 0.5s, font-weight 0.5s, font-size 0.2s; /* إضافة transition لحجم الخط */
            white-space: pre-wrap; /* الحفاظ على الأسطر مع التفاف مناسب */
            overflow-wrap: anywhere; /* منع خروج النص عن الحدود */
        }

        /* منع تحديد النص لكل شيء ما عدا الأدعية */
        body, .app-container, .main-title, .section-title, .prayer-card, header, nav, button, h1, h2, h3, span, p {
            user-select: none;
        }
        .supplication-text {
            user-select: text !important; /* السماح بتحديد نص الأدعية فقط */
        }

        

        /* تنسيق شريط الأدوات */
        .control-toolbar {
            display: flex;
            justify-content: flex-start;
            gap: 8px;
            padding: 10px 0;
            margin-top: 10px;
            border-radius: 10px 10px 0 0;
        }
        .control-toolbar button {
            padding: 6px 10px;
            border-radius: 8px;
            font-weight: bold;
            transition: background-color 0.2s, transform 0.1s;
        }

        /* إخفاء عناصر التحكم عند الطباعة */
        @media print {
            .app-container, header, nav, button, .control-toolbar, .section-title, .mb-6 {
                display: none !important;
            }
            body {
                background-color: white !important;
                color: black !important;
            }
            .supplication-text {
                font-size: 14pt !important;
                line-height: 1.8 !important;
                color: black !important;
                user-select: auto !important;
                font-weight: 400 !important;
            }
            .prayer-card {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin-bottom: 20px;
                break-inside: avoid; /* منع فصل الدعاء الواحد بين صفحات الطباعة */
            }
            .collapsible-content {
                max-height: none !important; /* إظهار المحتوى بالكامل للطباعة */
            }
            .collapsible-trigger {
                display: none !important;
            }
            h3 {
                font-size: 16pt !important;
                color: black !important;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body class="light-mode">
    <div class="app-container">
        <div class="container mx-auto px-4 pb-20">
            <header class="py-8 text-center relative">
                <button id="darkModeToggle" class="absolute top-8 left-4 bg-white/50 dark:bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full text-xs shadow-sm" onclick="toggleDarkMode()">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="flex justify-center items-center gap-3">
                    <img src="https://r2.fivemanage.com/5dNb5IfXLHmmadhqnoSnS/.png" alt="logo" class="w-10 h-10 opacity-80 dark:opacity-70 rounded-full">
                    <h1 class="main-title text-4xl font-bold">تعقيبات الصلاة</h1>
                </div>
            </header>
            
            <main>
                <section id="home-section">
                    <nav class="mb-8 flex flex-col gap-4 items-center">
                        <button class="main-tab-btn w-full px-4 py-3 rounded-xl font-bold text-white text-xl shadow-lg" style="background-color: #58a67d;" onclick="showTab('taqibat')">تعقيبات الصلاة</button>
                        <button class="main-tab-btn w-full px-4 py-3 rounded-xl font-bold text-white text-xl shadow-lg" style="background-color: #58a67d;" onclick="showTab('days')">أدعية الأيام</button>
                        <button class="main-tab-btn w-full px-4 py-3 rounded-xl font-bold text-white text-xl shadow-lg" style="background-color: #58a67d;" onclick="showTab('ashura')">زيارة عاشوراء</button>
                        <button class="main-tab-btn w-full px-4 py-3 rounded-xl font-bold text-white text-xl shadow-lg" style="background-color: #58a67d;" onclick="showTab('hujjah')">زيارة الحجة بعد صلاة الفجر</button>
                        <button class="main-tab-btn w-full px-4 py-3 rounded-xl font-bold text-white text-xl shadow-lg" style="background-color: #58a67d;" onclick="showTab('tasbeeh')">المسبحة</button>
                    </nav>
                </section>

                <section id="taqibat-section" style="display:none;">
                    <h2 class="section-title text-2xl font-bold mb-4">النصوص الكاملة للتعقيبات</h2>
                    <button onclick="showTab('home')" class="mb-6 px-4 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 dark:bg-zinc-700 dark:text-zinc-200 hover:bg-gray-400 dark:hover:bg-zinc-600 transition">
                        <i class="fas fa-arrow-right ml-2"></i> الرجوع للرئيسية
                    </button>
                    <div class="space-y-5">
    <div class="prayer-card p-5">
        <button class="w-full text-right flex justify-between items-center collapsible-trigger">
            <h3 class="text-xl font-bold">تعقيب صلاة الصبح</h3>
            <i class="fas fa-chevron-down transition-transform duration-300"></i>
        </button>
        <div class="collapsible-content">
            <div class="control-toolbar flex justify-between items-center">
                <div class="flex gap-2">
                    <button onclick="changeFontSize(1)"><i class="fas fa-magnifying-glass-plus"></i></button>
                    <button onclick="changeFontSize(-1)"><i class="fas fa-magnifying-glass-minus"></i></button>
                    <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                </div>
                <div class="flex gap-2">
                    <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                    <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                </div>
            </div>
            <p class="supplication-text">
اللهُمَّ صَلِّ عَلى مُحَمَّدٍ وَآلِ مُحَمَّدٍ وَاهدِني لِما اختُلِفَ فيهِ مِنَ الحَقِّ بِإذنِكَ، إنَّكَ تَهدي مَن تَشاءُ إلى صِراطٍ مُستَقيمٍ.

وتقول عشر مرّات: اللهُمَّ صَلِّ عَلى مُحَمَّدٍ وَآل مُحَمَّدٍ الأوصياءِ الرَّاضينَ المَرضيّينَ بِأفضَلِ صَلَواتِـكَ، وَبارك عَلَيهِم بِأفضَلِ بَرَكاتِكَ، وَالسَّلامُ عَلَيهِم وَعَلى أرواحِهِم وَأجسادِهِم وَرَحمَةُ اللهِ وَبَرَكاتُهُ.   <br>
            </p>
        </div>
    </div>
    <div class="prayer-card p-5">
        <button class="w-full text-right flex justify-between items-center collapsible-trigger">
            <h3 class="text-xl font-bold">تعقيب صلاة الظهر</h3>
            <i class="fas fa-chevron-down transition-transform duration-300"></i>
        </button>
        <div class="collapsible-content">
             <div class="control-toolbar flex justify-between items-center">
                <div class="flex gap-2">
                    <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                    <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                    <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                </div>
                <div class="flex gap-2">
                    <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                    <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                </div>
            </div>
            <p class="supplication-text">
لا إلهَ إلاّ اللهُ العَظيمُ الحَليمُ، لا إلهَ إلاّ الله رَبُّ العَرشِ الكَريمُ، الحَمدُ للهِ رَبِّ العالَمينَ. اللهُمَّ إنّي أسألُكَ مُوجِباتِ رَحمَتِكَ وَعَزائِمَ مَغفِرَتِكَ، وَالغَنيمَةَ مِن كُلِّ بِرٍّ، وَالسَّلامَةَ مِن كُلِّ إثمٍ. اللهُمَّ لا تَدع لي ذَنباً إلاّ غَفَرتَهُ، وَلا هَمّاً إلاّ فَرَّجتَهُ، وَلا سُقماً إلاّ شَفَيتَهُ، وَلا عَيباً إلاّ سَتَرتَهُ، وَلا رِزقاً إلاّ بَسَطتَهُ، وَلا خَوفاً إلاّ آمَنتَهُ، وَلا سوءاً إلاّ صَرَفتَهُ، وَلا حاجَةً هيَ لَكَ رِضاً وَليَ فيها صَلاحٌ إلاّ قَضَيتَها ؛ يا أرحَمَ الرَّاحِمينَ آمينَ رَبَّ العالَمينَ.   <br>
            </p>
        </div>
    </div>
    <div class="prayer-card p-5">
        <button class="w-full text-right flex justify-between items-center collapsible-trigger">
            <h3 class="text-xl font-bold">تعقيب صلاة العصر</h3>
            <i class="fas fa-chevron-down transition-transform duration-300"></i>
        </button>
        <div class="collapsible-content">
             <div class="control-toolbar flex justify-between items-center">
                <div class="flex gap-2">
                    <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                    <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                    <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                </div>
                <div class="flex gap-2">
                    <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                    <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                </div>
            </div>
            <p class="supplication-text">
أستَغفِرُ اللهَ الَّذي لا إلهَ إلاّ هُوَ الحَيُّ القَيّومُ الرَّحمنُ الرَّحيمُ ذو الجَلالِ وَالإكرامِ، وَأسألُهُ أن يَتوبَ عَلَيَّ تَوبَةَ عَبدٍ ذَليلٍ خاضِعٍ فَقيرٍ بائِسٍ مِسكينٍ مُستَكينٍ مُستَجيرٍ، لا يملك لِنَفسِهِ نَفعاً وَلا ضَرّاً وَلا مَوتاً وَلا حياةً وَلا نُشوراً.

ثمّ تقول: اللهُمَّ إنّي أعوذُ بِكَ مِن نَفسٍ لا تَشبَعُ، وَمِن قَلبٍ لا يَخشَعُ، وَمِن عِلمٍ لا يَنفَعُ، وَمِن صَلاةٍ لا تُرفَعُ، وَمِن دُعاءٍ لا يُسمَعُ. 

اللهُمَّ إنّي أسألُكَ اليُسرَ بَعدَ العُسرِ وَالفَرَجَ بَعدَ الكَربِ وَالرَّخاءَ بَعدَ الشِّدَّةِ. 

اللَّهُمَّ ما بِنا مِن نِعمَةٍ فَمِنكَ لا إلهَ إلاّ أنتَ. أستَغفِرُكَ وَأتوبُ إلَيكَ.   <br>

            </p>
        </div>
    </div>
    <div class="prayer-card p-5">
        <button class="w-full text-right flex justify-between items-center collapsible-trigger">
            <h3 class="text-xl font-bold">تعقيب صلاة المغرب</h3>
            <i class="fas fa-chevron-down transition-transform duration-300"></i>
        </button>
        <div class="collapsible-content">
             <div class="control-toolbar flex justify-between items-center">
                <div class="flex gap-2">
                    <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                    <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                    <button onclick="resetFontSize()" title="إرجاع الحجم"><i class="fas fa-font"></i></button>
                </div>
                <div class="flex gap-2">
                    <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                    <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                </div>
            </div>
            <p class="supplication-text">
اللهُمَّ إنَّهُ لَيسَ لي عِلمٌ بِمَوضِعِ رِزقي وَإنَّما أطلُبُهُ بِخَطَراتٍ تَخطُرُ عَلى قَلبي، فَأجولُ في طَلَبِهِ البُلدانَ، فَأنا فيما أنا طالِبٌ كَالحَيرانِ، لا أدري أفي سَهلٍ هوَ، أم في جَبَلٍ، أم في أرضٍ، أم في سَماءٍ، أم في بَرٍّ أم في بَحرٍ ؟ وَعَلى يَدَي مَن، وَمِن قِبَلِ مَن؟ وَقَد عَلِمتُ أنَّ عِلمَهُ عِندَكَ وَأسبابَهُ بيَدِكَ، وَأنتَ الَّذي تَقسِمُهُ بِلُطفِكَ، وَتُسَبِّبُهُ بِرَحمَتِكَ. اللهُمَّ فَصَلِّ عَلى مُحَمَّدٍ وَآلِهِ، وَاجعَل يا رَبِّ رِزقَكَ لي وَاسِعاً وَمَطلَبَهُ سَهلاً وَمَأخَذَهُ قَريباً، وَلا تُعَـنِّـني بِطَلَبِ ما لَم تُقَدِّر لي فيهِ رِزقاً، فَإنَّكَ غَنيُّ عَن عَذابي وَأنا فَقيرٌ إلى رَحمَتِكَ، فَصَلِّ عَلى مُحَمَّدٍ وَآلِهِ وَجُد عَلى عَبدِكَ بِفَضلِكَ، إنَّكَ ذو فَضلٍ عَظيمٍ.   <br>
            </p>
        </div>
    </div>
    <div class="prayer-card p-5">
        <button class="w-full text-right flex justify-between items-center collapsible-trigger">
            <h3 class="text-xl font-bold">تعقيب صلاة العشاء</h3>
            <i class="fas fa-chevron-down transition-transform duration-300"></i>
        </button>
        <div class="collapsible-content">
             <div class="control-toolbar flex justify-between items-center">
                <div class="flex gap-2">
                    <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                    <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                    <button onclick="resetFontSize()" title="إرجاع الحجم"><i class="fas fa-font"></i></button>
                </div>
                <div class="flex gap-2">
                    <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                    <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                </div>
            </div>
            <p class="supplication-text">
اللهُمَّ إنَّهُ لَيسَ لي عِلمٌ بِمَوضِعِ رِزقي وَإنَّما أطلُبُهُ بِخَطَراتٍ تَخطُرُ عَلى قَلبي، فَأجولُ في طَلَبِهِ البُلدانَ، فَأنا فيما أنا طالِبٌ كَالحَيرانِ، لا أدري أفي سَهلٍ هوَ، أم في جَبَلٍ، أم في أرضٍ، أم في سَماءٍ، أم في بَرٍّ أم في بَحرٍ ؟ وَعَلى يَدَي مَن، وَمِن قِبَلِ مَن؟ وَقَد عَلِمتُ أنَّ عِلمَهُ عِندَكَ وَأسبابَهُ بيَدِكَ، وَأنتَ الَّذي تَقسِمُهُ بِلُطفِكَ، وَتُسَبِّبُهُ بِرَحمَتِكَ. اللهُمَّ فَصَلِّ عَلى مُحَمَّدٍ وَآلِهِ، وَاجعَل يا رَبِّ رِزقَكَ لي وَاسِعاً وَمَطلَبَهُ سَهلاً وَمَأخَذَهُ قَريباً، وَلا تُعَـنِّـني بِطَلَبِ ما لَم تُقَدِّر لي فيهِ رِزقاً، فَإنَّكَ غَنيُّ عَن عَذابي وَأنا فَقيرٌ إلى رَحمَتِكَ، فَصَلِّ عَلى مُحَمَّدٍ وَآلِهِ وَجُد عَلى عَبدِكَ بِفَضلِكَ، إنَّكَ ذو فَضلٍ عَظيمٍ.   <br>
            </p>
        </div>
    </div>
    
                    </div>
                </section>

                <section id="days-section" style="display:none;">
    <h2 class="section-title text-2xl font-bold mb-4">أدعية الأيام</h2>
    <button onclick="showTab('home')" class="mb-6 px-4 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 dark:bg-zinc-700 dark:text-zinc-200 hover:bg-gray-400 dark:hover:bg-zinc-600 transition">
        <i class="fas fa-arrow-right ml-2"></i> الرجوع للرئيسية
    </button>
    <div class="space-y-5">
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم السبت</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
بِسمِ اللهِ كَلِمَةِ المُعتَصِمينَ وَمَقالَةِ المُتَحَرِّزينَ، وَأعوذُ بِالله تَعالى مِن جَورِ الجائِرينَ، وَكَيدِ الحاسِدينَ وَبَغي الظّالِمينَ، وَأحمَدُهُ فَوقَ حَمدِ الحامِدينَ. اللهُمَّ أنتَ الواحِدُ بِلا شَريكٍ، وَالمَلِكُ بِلا تَمليكٍ، لا تُضادُّ في حُكمِكَ، وَلا تُنازَعُ في مُلكِكَ. أسألُكَ أن تُصَلّيَ عَلى مُحَمَّدٍ عَبدِكَ وَرَسولِكَ، وَأن توزِعَني مِن شُكرِ نُعماكَ ما تَبلُغُ بي غايَةَ رِضاكَ، وَأن تُعينَني عَلى طاعَتِكَ وَلُزومِ عِبادَتِكَ وَاستِحقاقِ مَثوبَتِكَ بِلُطفِ عِنايَتِكَ، وَتَرحَمَني بِصَدّي عَن مَعاصيكَ ما أحيَيتَني، وَتوَفِّقَني لِما يَنفَعُني ما أبقَيتَني، وَأن تَشرَحَ بِكِتابِكَ صَدري، وَتَحُطَّ بِتِلاوَتِهِ وِزري، وَتمنَحَني السَّلامَةَ في ديني وَنَفسي، وَلا توحِشَ بي أهلَ اُنسي، وَتُتِمَّ إحسانَكَ فيما بَقيَ مِن عُمري كَما أحسَنتَ فيما مَضى مِنهُ، يا أرحَمَ الرَّاحِمينَ.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الأحد</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
بِسمِ الله الَّذي لا أرجو إلاّ فَضلَهُ، وَلا أخشى إلاّ عَدلَهُ، وَلا أعتَمِدُ إلاّ قَولَهُ، وَلا اُمسِكُ إلاّ بِحَبلِهِ. بِكَ أستَجيرُ يا ذا العَفوِ وَالرِّضوانِ مِن الظُّلمِ وَالعُدوانِ، وَمِن غِيَرِ الزَّمانِ، وَتواتُرِ الأحزانِ، وَطوارِقِ الحَدَثانِ، وَمِن انقضاء المُدَّةِ قَبلَ التَّأَهُبِ وَالعُدَّةِ. وَإياكَ أستَرشِدُ لِما فيهِ الصَّلاحُ وَالإصلاحُ، وَبِكَ أستَعينُ فيما يَقتَرِنُ بِهِ النَّجاحُ وَالإنجاحُ، وَإياكَ أرغَبُ في لِباسِ العافيَةِ وَتَمامِها وَشُمولِ السَّلامَةِ وَدَوَامِها، وأعوذُ بِكَ يا رَبِّ مِن هَمَزاتِ الشَّياطينِ، وَأحتَرِزُ بِسُلطانِكَ مِن جَورِ السَّلاطينِ. فَتَقَبَّل ما كانَ مِن صَلاتي وَصَومي، وَاجعَل غَدي وَما بَعدَهُ أفضَلَ مِن ساعَتي وَيَومي، وَأعِزَّني في عَشيرَتي وَقَومي ، وَاحفَظني في يَقظَتي وَنَومي، فَأنتَ اللهُ خَيرٌ حافِظاً وَأنتَ أرحَمُ الرّاحِمينَ.<br>
اللهُمَّ إنّي أبرأُ إلَيكَ في يَومي هذا وَما بَعدَهُ مِنَ الآحادِ مِنَ الشِّركِ وَالإلحادِ، وَاُخلِصُ لَكَ دُعائي تَعَرُّضاً لِلإجابَةِ، وَاُقيمُ عَلى طاعَتِكَ رَجاءً لِلإثابَةِ، فَصَلِّ عَلى مُحَمَّدٍ خَيرِ خَلقِكَ الدَّاعي إلى حَقِّكَ، وَأعِزَّني بِعِزِّكَ الَّذي لا يُضامُ، وَاحفَظني بِعَينِكَ الَّتي لا تَنامُ، وَاختِم بِالانقِطاعِ إلَيكَ أمري وَبِالمَغفِرَةِ عُمري، إنَّكَ أنتَ الغَفورُ الرَّحيم.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الإثنين</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
الحَمدُ للهِ الَّذي لَم يُشهِد أحَداً حينَ فَطَرَ السَّماواتِ وَالأرضَ ، وَلا اتَّخَذَ مُعيناً حينَ بَرَأ النَّسَماتِ. لَم يُشارَك في الإلهيَّةِ، وَلَم يُظاهَر في الوَحدانِيَّةِ. كَلَّتِ الألسُنُ عَن غايَةِ صِفَتِهِ، وَالعُقولُ عَن كُنهِ مَعرِفَتِهِ، وَتَواضَعَتِ الجَبابِرَةُ لِهَيبَتِهِ، وَعَنَتِ الوُجوهُ لِخَشيَتِهِ، وَانقادَ كُلُّ عَظيمٍ لِعَظَمَتِهِ.<br>
فَلَكَ الحَمدُ مُتَواتِراً مُتَّسِقاً ومُتَوالياً مُستَوسِقاً وَصَلَواتُهُ عَلى رَسولِهِ أبَداً وَسَلامُهُ دائِماً سَرمَداً.<br>
اللهُمَّ اجعَل أوَّلَ يَومي هذا صَلاحاً وَأوسَطَهُ فَلاحاً وَآخِرَهُ نَجاحاً، وَأعوذُ بِكَ مِن يَومٍ أوَّلُهُ فَزَعٌ، وَأوسَطُهُ جَزَعٌ وَآخِرُهُ وَجَعٌ. اللهُمَّ إنّي أستَغفِرُكَ لكلّ نَذرٍ نَذَرتُهُ وَكُلِّ وَعدٍ وَعَدتُهُ، وَكُلِّ عَهدٍ عاهَدتُهُ ثمّ لَم أفِ بِهِ، وَأسألُكَ في مَظالِمِ عِبادِكَ عِندي فَأيُّما عَبدٍ مِن عَبيدِكَ أو أمَةٍ مِن إمائِكَ كانَت لَهُ قِبَلي مَظلِمَةٌ ظَلَمتُها إياهُ في نَفسِهِ، أو في عِرضِهِ أو في مالِهِ أو في أهلِهِ وَوُلْدِهِ، أو غيبَةٌ اغتَبتُهُ بِها، أو تَحامُلٌ عَلَيهِ بِمَيلٍ، أو هَوَىً، أو أنَفَةٍ أو حَميَّةٍ، أو رياءٍ أو عَصَبيَّةٍ، غائِباً كانَ أو شاهِداً، وحَياً كانَ أو مَيِّتاً، فَقَصُرَت يَدي وَضاقَ وُسعي عَن رَدِّها إلَيهِ والتَحَلُّلِ مِنهُ، فَأسألُكَ يا مَن يَملِكُ الحاجاتِ وَهي مُستَجيبَةٌ لِمَشيئَتِهِ وَمُسرِعَةٌ إلى إرادَتِهِ أن تُصَلِّيَ عَلى مُحَمَّدٍ وَآلِ مُحَمَّدٍ وَأن تُرضيَهُ عَنّي بِما شِئتَ، وَتَهَبَ لي مِن عِندِكَ رَحمَةً إنَّهُ لا تَنقُصُكَ المَغفِرَةُ ولا تَضُرُّكَ المَوهِبَةُ، يا أرحَمَ الرَّاحِمينَ.

اللهُمَّ أولِني في كُلِّ يَومٍ اثنينِ نِعمَتَينِ مِنكَ ثِنتَينِ: سَعادَةً في أوَّلِهِ بِطاعَتِكَ، وَنِعمَةً في آخِرِهِ بِمَغفِرَتِكَ، يا مَن هُوَ الإلهُ وَلا يَغفِرُ الذُّنوبَ سِواهُ.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الثلاثاء</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
الحَمدُ للهِ وَالحَمدُ حَقُهُ كَما يَستِحِقُّهُ حَمداً كَثيراً، وَأعوذُ بِهِ مِن شَرِّ نَفسي ؛ إنَّ النَّفسَ لأمّارَةٌ بِالسّوءِ إلاّ ما رَحِمَ رَبّي، وَأعوذُ بِهِ مِن شَرِّ الشَّيطانِ الَّذي يَزيدُني ذَنباً إلى ذَنبي، وَاحتَرِزُ بِهِ مِن كُلِّ جَبّارٍ فاجِرٍ، وَسُلطانٍ جائِرٍ، وَعَدوٍ قاهِرٍ. اللهُمَّ اجعَلني مِن جُندِكَ فَإنَّ جُندَكَ هُمُ الغالِبونَ، وَاجعَلني مِن حِزبِكَ فَإنَّ حِزبَكَ هُمُ المُفلِحونَ، وَاجعَلني مِن أوليائِكَ فَإنَّ أوليائكَ لا خَوفٌ عَلَيهِم وَلاهُم يَحزَنون. اللهُمَّ أصلِـح لي ديني فَإنَّهُ عِصمَةُ أمري، وَأصلِـح لي آخِرَتي فَإنَّها دارُ مَقَرّي وَإلَيها مِن مُجاوَرَةِ اللئامِ مَفَرّي، وَاجعَل الحياةَ زيادَةً لي في كُلِّ خَيرٍ وَالوَفاةَ راحَةً لي مِن كُلِّ شَرٍ اللهُمَّ صَلِّ عَلى مُحَمَّدٍ خاتَمِ النَّبيّينَ وَتَمامِ عِدَّةِ المُرسَلينَ، وَعَلى آلِهِ الطَّيِّبينَ الطَّاهِرينَ وَأصحابِهِ المُنتَجَبينَ، وَهَب لي في الثُّلاثاءِ ثَلاثاً: لاتَدَع لي ذَنباً إلاّ غَفَرتَهُ، وَلا غَمّاً إلاّ أذهَبتَهُ، وَلا عَدوّاً إلاّ دَفَعتَهُ. بِبِسمِ الله خَيرِ الأَسْماءِ، بِسمِ الله رَبِّ الأرضِ وَالسَّماء أستَدفِعُ كُلَّ مَكروهٍ أوَّلُهُ سَخَطُهُ، وَأستَجلِبُ كُلَّ مَحبوبٍ أوَّلُهُ رِضاهُ، فَاختِم لي مِنكَ بِالغُفرانِ يا وَليَّ الإحسانِ.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الأربعاء</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
الحَمدُ للهِ الَّذي جَعَلَ اللّيلَ لِباساً وَالنَّومَ سُباتاً، وَجَعَلَ النَّهارَ نُشوراً، لَكَ الحَمدُ أن بَعَثتَني مِن مَرقَدي وَلَو شِئتَ جَعَلتَهُ سَرمَداً، حَمداً دائِماً لا يَنقَطِعُ أبَداً وَلا يُحصي لَهُ الخَلائِقُ عَدَداً. اللهُمَّ لَكَ الحَمدُ أن خَلَقتَ فَسَوَّيتَ وَقَدَّرتَ وَقَضَيتَ وَأمَتَّ وَأحيَيتَ وَأمرَضتَ وَشَفَيتَ وَعافَيتَ وَأبلَيتَ، وَعَلى العَرشِ استَوَيتَ وَعَلى المُلكِ احتَوَيتَ. أدعوكَ دُعاءَ مَن ضَعُفَت وَسيلَتُهُ وَانقَطَعَت حيلَتُهُ وَاقتَرَبَ أجَلُهُ وَتَدانى في الدُّنيا أمَلُهُ، وَاشتَدَّت إلى رَحمَتِكَ فاقَتُهُ وَعَظُمَت لِتَفريطِهِ حَسرَتُهُ وَكَثُرَت زَلَّتُهُ وَعَثرَتُهُ وَخَلُصَت لِوَجهِكَ تَوبَتُهُ. فَصَلِّ عَلى مُحَمَّدٍ خاتَمِ النَّبيّينَ وَعَلى أهلِ بَيتِهِ الطَّيِّبينَ الطَّاهِرينَ، وَارزُقني شَفاعَةَ مُحَمَّدٍ (صلى الله عليه وآله) ، وَلا تَحرِمني صُحبَتَهُ إنَّكَ أنتَ أرحَمُ الرّاحِمينَ. اللهُمَّ اقضِ لي في الأربِعاءِ أربَعاً: اجعَل قوَّتي في طاعَتِكَ، وَنَشاطي في عِبادَتِكَ، وَرَغبَتي في ثَوابِكَ، وَزُهدي فيما يوجِبُ لي أليمَ عِقابِكَ، إنَّكَ لَطيفٌ لِما تَشاءُ.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الخميس</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
الحَمدُ للهِ الَّذي أذهَبَ اللَّيلَ مُظلِماً بِقُدرَتِهِ، وَجاءَ بِالنَّهارِ مُبصِراً بِرَحمَتِهِ، وَكَساني ضيائَهُ وَأنا في نِعمَتِهِ. اللهُمَّ فَكَما أبقَيتَني لَهُ فَأبقِني لأمثالِهِ، وَصَلِّ عَلى النَّبيّ مُحَمَّدٍ وَآلِهِ، وَلا تَفجَعني فيهِ وَفي غَيرِهِ مِنَ اللَّيالي وَالأيامِ بِارتِكابِ المَحارِمِ وَاكتِسابِ المَآثِمِ، وَارزُقني خَيرَهُ وَخَيرَ ما فيهِ وَخَيرَ ما بَعدَهُ، وَاصرِف عَنّي شَرَّهُ وَشَرَّ ما فيهِ وَشَرَّ ما بَعدَهُ. اللهُمَّ إنّي بِذِمَّةِ الإسلامِ أتَوَسَّلُ إلَيكَ، وَبِحُرمَةِ القُرآنِ أعتَمِدُ عَلَيكَ، وَبِمُحَمَّدٍ المُصطَفى (صلى الله عليه وآله) أستَشفِعُ لَدَيكَ، فَاعرِفِ اللهُمَّ ذِمَّتي الَّتي رَجَوتُ بِها قضاء حاجَتي، يا أرحَمَ الرَّاحِمينَ. اللهُمَّ اقضِ لي في الخَميسِ خَمساً: لا يَتَّسِعُ لَها إلاّ كَرَمُكَ، وَلا يُطيقُها إلاّ نِعَمُكَ: سَلامَةً أقوى بِها عَلى طاعَتِكَ، وَعِبادَةً أستَحِقُّ بِها جَزيلَ مَثوبَتِكَ، وَسَعَةً في الحالِ مِنَ الرّزقِ الحَلالِ، وَأن تُؤمِنَني في مَواقِفِ الخَوفِ بِأمنِكَ، وَتَجعَلَني مِن طَوارِقِ الهُمومِ وَالغُمومِ في حِصنِكَ، وَصَلِّ عَلى مُحمَّدٍ وَآلِ مُحَمَّدٍ، وَاجعَل تَوَسُّلي بِهِ شافِعاً يَومَ القيامة نافِعاً، إنَّكَ أنتَ أرحَمُ الرَّاحِمينَ.
                </p>
            </div>
        </div>
        <div class="prayer-card p-5">
            <button class="w-full text-right flex justify-between items-center collapsible-trigger">
                <h3 class="text-xl font-bold">دعاء يوم الجمعة</h3>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </button>
            <div class="collapsible-content">
                 <div class="control-toolbar flex justify-between items-center">
                    <div class="flex gap-2">
                        <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                        <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                        <button onclick="resetFontSize()" title="إرجاع الحجم"><i class="fas fa-font"></i></button>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                        <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </div>
                <p class="supplication-text">
بِسمِ الله الرَّحمنِ الرَّحيمِ<br>
الحَمدُ للهِ الأولِ قَبلَ الإنشاءِ وَالإحياءِ وَالآخرِ بَعدَ فَناءِ الأشياءِ، العَليمِ الَّذي لا يَنسى مَن ذَكَرَهُ وَلا يَنقُصُ مَن شَكَرَهُ وَلا يَخيبُ مَن دَعاهُ وَلا يَقطَعُ رَجاءَ مَن رَجاهُ. اللهُمَّ إنّي اُشهِدُكَ وَكَفى بِكَ شَهيداً، وَاُشهِدُ جَميعَ مَلائِكَتِكَ وَسُكَّانَ سَماواتِكَ وَحَمَلَةَ عَرشِكَ، وَمَن بَعَثتَ مِن أنبيائِكَ وَرُسُلِكَ، وَأنشَأتَ مِن أصنافِ خَلقِكَ، أنّي أشهَدُ أنَّكَ أنتَ اللهُ لا إلهَ إلاّ أنتَ وَحدَكَ لا شَريكَ لَكَ وَلا عَديلَ وَلا خُلفَ لِقَولِكَ وَلا تَبديلَ، وَأنَّ مُحَمَّداً (صلى الله عليه وآله) عَبدُكَ وَرَسولُكَ أدّى ما حَمَّلتَهُ إلى العِبادِ وَجاهَدَ في الله عَزَّ وَجلَّ حَقَّ الجِهادِ، وَأنَّهُ بَشَّرَ بِما هُوَ حَقٌ مِنَ الثَّوابِ، وَأنذَرَ بِما هُوَ صِدقٌ مِنَ العِقابِ. اللهُمَّ ثَبِّتني عَلى دينِكَ ما أحيَيتَني، وَلا تُزِغ قَلبي بَعدَ إذ هَدَيتَني، وَهَب لي مِن لَدُنكَ رَحمَةً إنَّكَ أنتَ الوَهّابُ ، صَلِّ عَلى مُحَمَّدٍ وَعَلى آل مُحَمَّدٍ، وَاجعَلني مِن أتباعِهِ وَشيعَتِهِ، وَاحشُرني في زُمرَتِهِ، وَوَفِّقني لأداءِ فَرضِ الجُمُعاتِ وَما أوجَبتَ عَلَيَّ فيها مِن الطّاعاتِ وَقَسَمتَ لأهلِها مِنَ العَطاءِ في يَومِ الجَزاءِ. إنَّكَ أنتَ العَزيزُ الحَكيمُ.
                </p>
            </div>
        </div>
    </div>
</section>

                <section id="ashura-section" style="display:none;">
                    <h2 class="section-title text-2xl font-bold mb-4">زيارة عاشوراء</h2>
                    <button onclick="showTab('home')" class="mb-6 px-4 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 dark:bg-zinc-700 dark:text-zinc-200 hover:bg-gray-400 dark:hover:bg-zinc-600 transition">
                        <i class="fas fa-arrow-right ml-2"></i> الرجوع للرئيسية
                    </button>
                    <div class="prayer-card p-5">
                         <div class="control-toolbar flex justify-between items-center">
                            <div class="flex gap-2">
                                <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                                <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                                <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                                <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
                            </div>
                        </div>
                        <p class="supplication-text">
السَّلامُ عَلَيكَ يا أبا عَبدِ اللهِ، السَّلامُ عَلَيكَ يا بنَ رَسُولِ اللهِ، السَّلامُ عَلَيكَ يا بنَ أمِيرِ المُؤمِنِينَ وَابنَ سَيِّدِ الوَصِيِّينَ، السَّلامُ عَلَيكَ يا بنَ فاطِمَةَ سَيِّدَةِ نِساءِ العالَمِينَ، السَّلامُ عَلَيكَ يا ثارَ اللهِ وَابنَ ثأرِهِ وَالوِترَ المَوتُورَ، السَّلامُ عَلَيكَ وَعَلى الأرواحِ الَّتي حَلَّت بِفِنائِكَ عَلَيكُم مِنّي جَميعاً سَلامُ اللهِ أبَداً ما بَقِيتُ وَبَقِيَ اللَيلُ وَالنَّهارُ.

يا أبا عَبدِ اللهِ لَقَد عَظُمَتِ الرَزِيَّةُ وَجَلّت وَعَظُمَتِ المُصِيبَةُ بِكَ عَلَينا وَعَلى جَمِيعِ أهلِ الإسلامِ، وَجَلَّت وَعَظُمَت مُصِيبَتُكَ في السَّماواتِ عَلى جَمِيعِ أهلِ السَّماواتِ، فَلَعَنَ اللهُ اُمَّةً أسَّسَت أساسَ الظُّلمِ وَالجَورِ عَلَيكُم أهلَ البَيتِ، وَلَعَنَ اللهُ اُمَّةً دَفَعَتكُم عَن مَقامِكُم وَأزالَتكُم عَن مَراتِبكُمُ الَّتي رَتَّبَكُمُ اللهُ فِيها، وَلَعَنَ اللهُ اُمَّةً قَتَلَتكُم وَلَعَنَ اللهُ المُمَهِّدِينَ لَهُم بِالتَّمكِينِ مِن قِتالِكُم، بَرِئتُ إلى اللهِ وَإلَيكُم مِنهُم وَمِن أشياعِهِم وَأتباعِهِم وَأوليائِهِم. يا أبا عَبدِ اللهِ إنّي سِلمٌ لِمَن سالَمَكُم وَحَربٌ لِمَن حارَبَكُم إلى يَومِ القيامة، وَلعَنَ اللهُ آلَ زيادٍ وَآلَ مرَوانَ وَلعَنَ اللهُ بَني اُمَيَّةَ قاطِبَةً وَلعَنَ اللهُ ابنَ مَرجانَةَ وَلعَنَ اللهُ عُمَرَ بنَ سَعدٍ وَلعَنَ اللهُ شِمراً، وَلعَنَ اللهُ اُمَّةً أسرَجَت وَألجَمَت وَتَنَقَّبَت لِقِتالِكَ، بِأبي أنتَ وَاُمّي لَقَد عَظُمَ مُصابي بِكَ فَأسألُ اللهَ الَّذي أكرَمَ مَقامَكَ وَأكرَمَني بِكَ أن يَرزُقَني طَلَبَ ثأرِكَ مَعَ إمامٍ مَنصُورٍ مِن أهلِ بَيتِ مُحَمَّدٍ (صلى الله عليه وآله) . اللهُمَّ اجعَلني عِندَكَ وَجِيهاً بِالحُسَينِ (عليه السلام) في الدُّنيا وَالآخِرةِ، يا أبا عَبدِ اللهِ إنّي أتَقَرَّبُ إلى اللهِ وَإلى رَسُولِهِ وَإلى أمِيرِ المُؤمِنِينَ وَإلى فاطِمَةَ وَإلى الحَسَنِ وَإلَيكَ بِمُوالاتِكَ وَبِالبَراءَةِ مِمَّن قاتَلَكَ وَنَصَبَ لَكَ الحَرْبَ وَبِالبَراءَةِ مِمَّنْ أَسَّسَ أَساسَ الظُّلْمِ وَالجَوْرِ عَلَيْكُمْ ، وَأَبْرَأُ إِلى الله وَإِلى رَسُولِهِ مِمَّنْ أسَّسَ أساسَ ذلِكَ وَبَنى عَلَيهِ بُنيانَهُ وَجَرى في ظُلمِهِ وَجَورِهِ عَلَيكُم وَعَلى أشياعِكُم، بَرِئتُ إلى اللهِ وَإلَيكُم مِنهُم وَأتَقَرَّبُ إلى اللهِ ثُمَّ إلَيكُم بِمُوالاتِكُم وَمُوالاةِ وَلِيِّكُم وَالبَراءَةِ مِن أعدائِكُم وَالنَّاصِبِينَ لَكُم الحَربَ وَبِالبَراءَةِ مِن أشياعِهِم وَأتباعِهِم.
إنّي سِلمٌ لِمَن سالَمَكُم وَحَربٌ لِمَن حارَبَكُم وَوَلِيُّ لِمَن وَالاكُم وَعَدُوٌ لِمَن عاداكُم، فَأسألُ اللهَ الَّذي أكرَمَني بِمَعرِفَتِكُم وَمَعرِفَةِ أوليائِكُم وَرَزَقَني البَراءَةَ مِن أعدائِكُم أن يَجعَلَني مَعَكُم في الدُّنيا وَالآخِرةِ وَأن يُثَبِّتَ لي عِندَكُم قَدَمَ صِدقٍ في الدُّنيا وَالآخِرَةِ، وَأسألُهُ أن يُبَلِّغَني المَقامَ المَحمُودَ لَكُم عِندَ اللهِ وَأن يَرزُقَني طَلَبَ ثارِي مَعَ إمامٍ هُدىً ظاهِرٍ ناطِقٍ بِالحَقِّ مِنكُم، وَأسألُ اللهَ بِحَقِّكُم وَبِالَّشأنِ الَّذي لَكُم عِندَهُ أن يُعطِيَني بِمُصابي بِكُم أفضَلَ ما يُعطي مُصاباً بِمُصِيبَتِهِ، مُصِيبَةً ما أعظَمَها وَأعظَمَ رَزِيَّتَها في الإسلامِ وَفي جَمِيعِ السَّماواتِ وَالأرضِ، اللهُمَّ اجعَلني في مَقامي هذا مِمَّن تَنالَهُ مِنكَ صَلَواتٌ وَرَحمَةٌ وَمَغفِرَهٌ، اللهُمَّ اجعَل مَحيايَ مَحيا مُحَمَّدٍ وَآلِ مُحَمَّدٍ وَمَماتي مَماتَ مُحَمَّدٍ وَآلِ مُحَمَّدٍ، اللهُمَّ إنَّ هذا يَومٌ تَبَرَّكَت بِهِ بَنُو اُمَيَّةَ وَابنُ آكِلَةِ الأكبادِ اللَّعِينُ ابنُ اللَّعِينِ عَلى لِسانِكَ وَلِسانِ نَبِيِّكَ (صلى الله عليه وآله) في كُلِّ مَوطِنٍ وَمَوقِفٍ وَقَفَ فِيهِ نَبِيُّكَ (صلى الله عليه وآله) .
اللهُمَّ العَن أبا سُفيانَ وَمُعاوِيَةَ وَيَزِيدَ بنَ مُعاوِيَةَ عَلَيهِم مِنكَ اللَّعنَةُ أبَدَ الآبِدِينَ، وَهذا يَومٌ فَرِحَت بِهِ آلُ زيادٍ وَآلُ مَروانَ بِقَتلِهِمُ الحُسَينَ (صلوات الله عليه) ، اللهُمَّ فَضاعِف عَلَيهِم اللَّعنَ مِنكَ وَالعَذابَ الأَلِيمَ، اللهُمَّ إنّي أتَقَرَّبُ إلَيكَ في هذا اليَومِ وَفي مَوقِفي هذا وَأيامِ حياتي بِالبَراءَةِ مِنهُم وَاللَّعنَةِ عَلَيهِم وَبِالمُوالاةِ لِنَبِيِّكَ وَآلِ نَبِيِّكَ عَلَيهِ وَ (عليهم السلام) .
ثمّ تقول مائة مرة: اللهُمَّ العَن أوَّلَ ظالِمٍ ظَلَمَ حَقَّ مُحَمَّدٍ وَآلِ مُحَمَّدٍ وَآخِرَ تابِعٍ لَهُ عَلى ذلِكَ، اللهُمَّ العَن العِصابَةَ الَّتي جاهَدَتِ الحُسَينَ وَشايَعَت وَبايَعَت وَتابَعَت عَلى قَتلِهِ اللهُمَّ العَنهُم جَميعاً.
ثمّ تقول مائة مرة: السَّلامُ عَلَيكَ يا أبا عَبدِ اللهِ وَعَلى الأرواحِ الَّتي حَلَّت بِفِنائِكَ، عَلَيكَ مِنّي سَلامُ اللهِ أبَداً ما بَقِيتُ وَبَقِيَ اللَيلُ وَالنَّهارُ وَلا جَعَلَهُ اللهُ آخِرَ العَهدِ مِنّي لِزيارَتِكُم. السَّلامُ عَلى الحُسَينِ وَعَلى عَلِيِّ بنِ الحُسَينِ وَعَلى أولادِ الحُسَينِ وَعَلى أصحابِ الحُسَينِ.
ثمّ تقول: اللهُمَّ خُصَّ أنتَ أوَّلَ ظالِمٍ بِاللَّعنِ مِنّي وَأبدأ بِهِ أوَّلاً ثُمَّ العَن الثَّاني وَالثَّالِثَ وَالرَّابِعَ، اللهُمَّ العَن يَزِيدَ خامِساً وَالعَن عُبَيدَ اللهِ بنَ زيادٍ وَابنَ مَرجانَةَ وَعُمَرَ بنَ سَعدٍ وَشِمراً وَآلَ أبي سُفيانَ وَآلَ زيادٍ وَآلَ مروانَ إلى يَومِ القيامة.
ثمّ تسجد وتقول: اللهُمَّ لَكَ الحَمدُ حَمدَ الشَّاكِرِينَ لَكَ عَلى مُصابِهِم، الحَمدُ للهِ عَلى عَظِيمِ رَزِيَّتِي، اللهُمَّ ارزُقني شَفاعَةَ الحُسَينِ يَومَ الوُرُودِ وَثَبِّت لي قَدَمَ صِدقٍ عِندَكَ مَعَ الحُسَينِ وَأصحابِ الحُسَينِ الَّذِينَ بَذَلُوا مُهَجَهُم دُونَ الحُسَينِ (عليه السلام) .
        </p>
    </div>
</section>

                <section id="hujjah-section" style="display:none;">
    <h2 class="section-title text-2xl font-bold mb-4">زيارة الحجة بعد صلاة الفجر</h2>
    <button onclick="showTab('home')" class="mb-6 px-4 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 dark:bg-zinc-700 dark:text-zinc-200 hover:bg-gray-400 dark:hover:bg-zinc-600 transition">
        <i class="fas fa-arrow-right ml-2"></i> الرجوع للرئيسية
    </button>
    <div class="prayer-card p-5">
         <div class="control-toolbar flex justify-between items-center">
            <div class="flex gap-2">
                <button onclick="changeFontSize(1)" title="تكبير الخط"><i class="fas fa-magnifying-glass-plus"></i></button>
                <button onclick="changeFontSize(-1)" title="تصغير الخط"><i class="fas fa-magnifying-glass-minus"></i></button>
                <button onclick="resetFontSize()"><i class="fas fa-font"></i></button>
            </div>
            <div class="flex gap-2">
                <button onclick="copySupplication(this)"><i class="fas fa-copy"></i> نسخ</button>
                <button onclick="printSupplication(this)"><i class="fas fa-print"></i> طباعة</button>
            </div>
        </div>
        <p class="supplication-text">
اللهُمَّ بَلِّغ مَولايَ صاحِبَ الزَّمانِ (صلوات الله عليه) عَن جَمِيعِ المُؤمِنِينَ وَالمُؤمِناتِ في مَشارِقِ الأرضِ وَمَغارِبِها وَبَرِّها وَبَحرِها وَسَهلِها وَجَبَلِها، حَيِّهِم وَمَيِّتِهِم وَعَن وَالِدَيَّ وَوُلدي وَعَنّي مِنَ الصَّلَواتِ وَالتَّحياتِ زِنَةَ عَرشِ اللهِ وَمِدادَ كَلِماتِهِ وَمُنتَهى رِضاهُ وَعَدَدَ ما أحصاهُ كِتابُهُ وَأحاطَ بِهِ عِلمُهُ، اللهُمَّ إنّي أُجَدِّدُ لَهُ في هذا اليَومِ وَفي كُلِّ يَومٍ عَهداً وَعَقداً وَبَيعَةً في رَقَبَتِي، اللهُمَّ كَما شَرَّفتَني بِهذا التَّشرِيفِ وَفَضَّلتَني بِهِذِهِ الفَضِيلَةِ وَخَصَصتَني بِهِذِهِ النِّعمَةِ فَصَلِّ عَلى مَولايَ وَسَيِّدي صاحِبِ الزَّمانِ، وَاجعَلني مِن أنصارِهِ وَأشياعِهِ وَالذَّابِّينَ عَنهُ وَاجعَلني مِنَ المُستَشهَدِينَ بَينَ يَدَيهِ طائِعاً غَيرَ مُكرَهٍ في الصَفِّ الَّذي نَعَتَّ أهلَهُ في كِتابِكَ، فَقُلتَ: صَفّا كَأنَّهُم بُنيا نٌ مَرصوصٌ عَلى طاعَتِكَ وَطاعَةِ رَسُولِكَ وَآلِهِ (عليهم السلام) ؛ اللهُمَّ هذِهِ بَيعَةٌ لَهُ في عُنُقي إلى يَومِ القيامة.        </p>
    </div>
</section>

                <section id="tasbeeh-section" style="display:none;">
    <h2 class="section-title text-2xl font-bold mb-4">المسبحة الإلكترونية</h2>
    <button onclick="showTab('home')" class="mb-6 px-4 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 dark:bg-zinc-700 dark:text-zinc-200 hover:bg-gray-400 dark:hover:bg-zinc-600 transition">
        <i class="fas fa-arrow-right ml-2"></i> الرجوع للرئيسية
    </button>
    <div class="prayer-card p-5 flex flex-col items-center gap-8">
        <span class="text-lg font-bold tasbeeh-phrase">تسبيحة الزهراء عليها السلام </span>
        
        <div class="tasbeeh-counter-bg rounded-full w-40 h-40 md:w-52 md:h-52 flex flex-col justify-center items-center shadow-2xl mb-4 p-4">
            <span id="tasbeeh-zahra-phrase" class="tasbeeh-phrase text-xl md:text-2xl font-bold mb-2 text-center leading-normal">الله أكبر</span>
            <span id="tasbeeh-zahra-counter" class="tasbeeh-counter-text text-4xl md:text-6xl font-extrabold transition-all duration-300">0</span>
        </div>

        <button onclick="incrementZahraCounter()" class="tasbeeh-btn bg-green-600 text-white p-10 text-4xl font-extrabold shadow-xl hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-4 focus:ring-green-300 dark:focus:ring-green-800">
            <i class="fas fa-hand-point-up"></i> إضغط هنا
        </button>

        <button onclick="resetZahraCounter()" class="tasbeeh-reset-btn px-6 py-3 rounded-xl text-lg font-bold shadow-md hover:shadow-lg transition duration-300 mt-4">
            <i class="fas fa-rotate-left ml-2"></i> إعادة الضبط
        </button>
        <p id="completion-message" class="text-green-600 dark:text-green-400 font-bold mt-4 text-center hidden p-2 rounded-lg bg-green-100 dark:bg-green-900/50">تمت تسبيحة الزهراء! تقبل الله صالح الأعمال.</p>
    </div>
    <div class="prayer-card p-5 flex flex-col items-center gap-8 mt-6">
        <span class="text-lg font-bold tasbeeh-phrase">تسبيح مفتوح</span>

        <div class="tasbeeh-counter-bg rounded-full w-40 h-40 md:w-52 md:h-52 flex flex-col justify-center items-center shadow-2xl mb-4 p-4">
            <span id="tasbeeh-open-phrase" class="tasbeeh-phrase text-xl md:text-2xl font-bold mb-2 text-center leading-normal">ذكر</span>
            <span id="tasbeeh-open-counter" class="tasbeeh-counter-text text-4xl md:text-6xl font-extrabold transition-all duration-300">0</span>
        </div>

        <button onclick="incrementOpenCounter()" class="tasbeeh-btn bg-green-600 text-white p-10 text-4xl font-extrabold shadow-xl hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-4 focus:ring-green-300 dark:focus:ring-green-800">
            <i class="fas fa-hand-point-up"></i> إضغط هنا
        </button>

        <button onclick="resetOpenCounter()" class="tasbeeh-reset-btn px-6 py-3 rounded-xl text-lg font-bold shadow-md hover:shadow-lg transition duration-300 mt-4">
            <i class="fas fa-rotate-left ml-2"></i> إعادة الضبط
        </button>
        <p id="open-completion-message" class="text-green-600 dark:text-green-400 font-bold mt-4 text-center hidden p-2 rounded-lg bg-green-100 dark:bg-green-900/50">تمت إعادة الضبط.</p>
    </div>
    </section>

            </main>
        </div>
    </div>

    
    <script>
        // ======= 1. دالة التبديل بين الأقسام (Tabs) =======
        function showTab(tabId) {
            const sections = document.querySelectorAll('main section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            const targetSection = document.getElementById(tabId + '-section');
            if (targetSection) {
                targetSection.style.display = 'block';
                // عند العودة للرئيسية، يتم عرض الصفحة الرئيسية
            } else if (tabId === 'home') {
                document.getElementById('home-section').style.display = 'block';
            }
            // إعادة ضبط العداد عند الانتقال لصفحة أخرى
                if (tabId !== 'tasbeeh') {
                    // reset both tasbeehs when leaving the tasbeeh tab
                    resetZahraCounter(false);
                    resetOpenCounter(false);
                }
        }

        // ======= 2. دالة تشغيل الوضع الفاتح والداكن (Dark/Light Mode) =======
        function toggleDarkMode() {
            const body = document.body;
            body.classList.toggle('dark-mode');
            body.classList.toggle('light-mode');
            
            const isDarkMode = body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');
            
            const toggleBtn = document.getElementById('darkModeToggle');
            if (isDarkMode) {
                toggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
                toggleBtn.classList.remove('text-gray-900');
                toggleBtn.classList.add('text-white');
            } else {
                toggleBtn.innerHTML = '<i class="fas fa-moon"></i>';
                toggleBtn.classList.remove('text-white');
                toggleBtn.classList.add('text-gray-900');
            }
        }
        
        // تطبيق الإعدادات المحفوظة عند تحميل الصفحة
        function applySavedSettings() {
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.remove('light-mode');
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.body.classList.remove('dark-mode');
                document.body.classList.add('light-mode');
                document.getElementById('darkModeToggle').innerHTML = '<i class="fas fa-moon"></i>';
            }
            // إظهار الصفحة الرئيسية عند التحميل
            showTab('home');
            
            // تطبيق حجم الخط المحفوظ
            loadFontSize();
        }

        // ======= 3. دالة طي/توسيع المحتوى (Collapsible) =======
        function setupCollapsibles() {
            const triggers = document.querySelectorAll('.collapsible-trigger');
            triggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    const content = trigger.nextElementSibling;
                    const icon = trigger.querySelector('.fas');

                    // إغلاق جميع الأقسام المفتوحة باستثناء القسم الحالي
                    triggers.forEach(t => {
                        if (t !== trigger) {
                            t.nextElementSibling.style.maxHeight = '0';
                            t.querySelector('.fas').classList.remove('rotate-180');
                        }
                    });

                    // توسيع أو طي القسم الحالي
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                        icon.classList.remove('rotate-180');
                    } else {
                        // استخدام scrollHeight لتحديد ارتفاع المحتوى بشكل ديناميكي
                        // يتم إضافة ارتفاع شريط الأدوات هنا، أو نعتمد على الإرتفاع الديناميكي
                        content.style.maxHeight = content.scrollHeight + 50 + 'px'; 
                        icon.classList.add('rotate-180');
                    }
                });
            });
        }
        
        // تحديث maxHeight عند تغيير حجم الخط
        function updateMaxHeight() {
             const openContents = document.querySelectorAll('.collapsible-content');
             openContents.forEach(content => {
                 if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                     // إعادة تعيين maxHeight لحساب الارتفاع الجديد
                     content.style.maxHeight = content.scrollHeight + 50 + 'px';
                 }
             });
        }
        
        // ======= 4. وظائف التحكم بحجم الخط (Font Size Control) =======
        const ROOT_FONT_SIZE_PX = 16; // حجم الخط الأساسي للـ body
        const INITIAL_REM_SIZE = 1.15; // الحجم الأساسي لـ supplication-text
        let currentRemSize = INITIAL_REM_SIZE;
        const STEP = 0.15;
        const MIN_SIZE = 0.9;
        const MAX_SIZE = 2.5;

        function updateFontSize() {
            // تطبيق المتغير على body لضمان تغليب قيمة المتغير المستخدمة في CSS
            document.body.style.setProperty('--supplication-font-size', `${currentRemSize}rem`);
            // وأيضاً على الجذر كاحتياط
            document.documentElement.style.setProperty('--supplication-font-size', `${currentRemSize}rem`);
            localStorage.setItem('supplicationFontSize', currentRemSize);
            // تحديث ارتفاع الحاويات القابلة للطي
            updateMaxHeight(); 
        }

        function changeFontSize(direction) { // direction: +1 for increase, -1 for decrease
            let newSize = currentRemSize + direction * STEP;
            if (newSize >= MIN_SIZE && newSize <= MAX_SIZE) {
                currentRemSize = newSize;
                updateFontSize();
            } function changeFontSize(direction) { 
    let newSize = currentRemSize + direction * STEP;
    if (newSize >= MIN_SIZE && newSize <= MAX_SIZE) {
        currentRemSize = newSize;
        updateFontSize();
    } else {
        // لا تسوي شيء إذا وصل الحد
        return;
    }
}

        }

        function resetFontSize() {
            currentRemSize = INITIAL_REM_SIZE;
            updateFontSize();
        }
        
        function loadFontSize() {
            const savedSize = parseFloat(localStorage.getItem('supplicationFontSize'));
            if (!isNaN(savedSize) && savedSize >= MIN_SIZE && savedSize <= MAX_SIZE) {
                currentRemSize = savedSize;
                updateFontSize();
            } else {
                updateFontSize(); // تطبيق الحجم الافتراضي (1.15rem)
            }
        }

        // ======= 5. وظائف النسخ والطباعة (Copy and Print) =======
        
        // دالة مساعدة للحصول على النص
        function getSupplicationText(triggerButton) {
            // دعم الحاويات القابلة للطي وغير القابلة للطي (مثل عاشوراء والحجة)
            const collapsible = triggerButton.closest('.collapsible-content');
            const card = triggerButton.closest('.prayer-card');
            const scope = collapsible || card || document;
            const supplicationParagraph = scope.querySelector('.supplication-text');
            return supplicationParagraph ? supplicationParagraph.innerText : '';
        }

        // دالة النسخ
        function copySupplication(triggerButton) {
            const textToCopy = getSupplicationText(triggerButton);
            if (textToCopy) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    // تغيير نص الزر مؤقتاً لتأكيد النسخ
                    const originalText = triggerButton.innerHTML;
                    triggerButton.innerHTML = '<i class="fas fa-check"></i> تم النسخ!';
                    setTimeout(() => {
                        triggerButton.innerHTML = originalText;
                    }, 1500);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                    alert('فشل في النسخ (قد يكون المتصفح لا يدعم هذه الميزة).');
                });
            }
        }

        // دالة الطباعة
        function printSupplication(triggerButton) {
            const contentContainer = triggerButton.closest('.prayer-card');
            // محاولة الحصول على العنوان من h3 داخل البطاقة، وإلا نأخذ من عنوان القسم
            let title = '';
            const h3 = contentContainer ? contentContainer.querySelector('h3') : null;
            if (h3 && h3.innerText) {
                title = h3.innerText;
            } else {
                const section = triggerButton.closest('section');
                const sectionTitle = section ? section.querySelector('h2.section-title') : null;
                title = sectionTitle ? sectionTitle.innerText : 'نص الدعاء';
            }
            const textToPrint = getSupplicationText(triggerButton);

            // كشف WebView في أندرويد ومحاولة الطباعة عبر تبويب خارجي (المتصفح)
            const ua = navigator.userAgent || '';
            const isAndroidWebView = /\bwv\b/i.test(ua) || (/Android/i.test(ua) && !/Chrome\/\d+/i.test(ua)) || /\bVersion\/\d+\.\d+ Chrome\/\d+ Mobile\b/i.test(ua);

            if (isAndroidWebView) {
                const html = `
      <html dir="rtl" lang="ar">
        <head>
          <meta charset="UTF-8">
          <title>${title}</title>
          <style>
            @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
            @page { margin: 12mm; }
            body { font-family: 'Tajawal', sans-serif; direction: rtl; text-align: right; line-height: 1.9; font-size: 16pt; color: #000; }
            h1 { font-size: 20pt; margin: 0 0 12px 0; padding: 0 0 8px 0; border-bottom: 2px solid #000; }
            p { margin: 0; }
          </style>
          <script>window.onload = function(){ window.print(); };<\/script>
        </head>
        <body>
          <h1>${title}</h1>
          <p>${textToPrint.replace(/\n/g, '<br>')}</p>
        </body>
      </html>`;
                const url = 'data:text/html;charset=utf-8,' + encodeURIComponent(html);
                // المحاولة 1: فتح تبويب جديد
                const win = window.open(url, '_blank');
                if (win && typeof win.focus === 'function') {
                    win.focus();
                    return;
                }
                // المحاولة 2: إنشاء رابط خفي والنقر عليه (قد يفتح خارجياً)
                const a = document.createElement('a');
                a.href = url;
                a.target = '_blank';
                a.rel = 'noopener noreferrer external';
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                setTimeout(() => a.remove(), 0);
                // إذا لم ينجح أي شيء، آخر حل: الانتقال مباشرةً داخل الـ WebView
                // يمكن للمستخدم الرجوع بعد الطباعة
                setTimeout(() => { try { location.href = url; } catch(e) {} }, 100);
                return;
            }

            // المتصفحات العادية: إنشاء iframe مخفي والطباعة داخله
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.style.width = '0';
            iframe.style.height = '0';
            iframe.style.border = '0';
            document.body.appendChild(iframe);

            const doc = iframe.contentWindow.document;
            doc.open();
            doc.write(`
                <html>
                    <head>
                        <meta charset="UTF-8">
                        <title>${title}</title>
                        <style>
                            @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
                            @page { margin: 12mm; }
                            body { font-family: 'Tajawal', sans-serif; direction: rtl; text-align: right; line-height: 1.9; font-size: 16pt; color: #000; }
                            h1 { font-size: 20pt; margin: 0 0 12px 0; padding: 0 0 8px 0; border-bottom: 2px solid #000; }
                            p { margin: 0; }
                        </style>
                    </head>
                    <body>
                        <h1>${title}</h1>
                        <p>${textToPrint.replace(/\n/g, '<br>')}</p>
                    </body>
                </html>
            `);
            doc.close();

            iframe.onload = () => {
                iframe.contentWindow.focus();
                iframe.contentWindow.print();
                setTimeout(() => document.body.removeChild(iframe), 500);
            };
        }

        // ======= 6. منطق المسبحة الإلكترونية (Tasbeeh Counter) =======
        
        const tasbeehPhrases = [
            { phrase: 'الله أكبر', limit: 34, key: 'allahuAkbar' },
            { phrase: 'الحمد لله', limit: 33, key: 'alhamdulillah' },
            { phrase: 'سبحان الله', limit: 33, key: 'subhanallah' }
        ];

        let zahraState = {
            currentPhraseIndex: 0,
            allahuAkbar: 0,
            alhamdulillah: 0,
            subhanallah: 0
        };

        // تحديث واجهة المستخدم بالقيم الحالية
        function updateZahraUI() {
            const current = tasbeehPhrases[zahraState.currentPhraseIndex];
            const currentCount = zahraState[current.key];
            
            document.getElementById('tasbeeh-zahra-phrase').textContent = current.phrase;
            document.getElementById('tasbeeh-zahra-counter').textContent = currentCount;
            document.getElementById('completion-message').classList.add('hidden');

            // تحديث لون العداد عند الانتقال للمرحلة النهائية (سبحان الله)
            const counterElement = document.getElementById('tasbeeh-zahra-counter');
            if (zahraState.currentPhraseIndex === 2) {
                 counterElement.classList.add('text-yellow-500', 'dark:text-yellow-300');
            } else {
                counterElement.classList.remove('text-yellow-500', 'dark:text-yellow-300');
            }

            // حفظ الحالة في التخزين المحلي
            localStorage.setItem('tasbeehState', JSON.stringify(zahraState));
        }

        // زيادة العداد
        function incrementZahraCounter() {
            if (zahraState.currentPhraseIndex >= tasbeehPhrases.length) {
                // إذا تم الانتهاء، يتم تجاهل الضغط أو إعادة الضبط
                document.getElementById('completion-message').classList.remove('hidden');
                return;
            }

            const current = tasbeehPhrases[zahraState.currentPhraseIndex];
            
            if (zahraState[current.key] < current.limit) {
                zahraState[current.key]++;
            }

            // التحقق من الانتقال إلى المرحلة التالية
            if (zahraState[current.key] === current.limit) {
                if (zahraState.currentPhraseIndex < tasbeehPhrases.length - 1) {
                    zahraState.currentPhraseIndex++;
                } else {
                    // تم إكمال التسبيحة كاملة (100 مرة)
                    zahraState.currentPhraseIndex++; // تجاوز الحد الأقصى لإظهار رسالة الإكمال
                    document.getElementById('completion-message').classList.remove('hidden');
                    // يمكن تركها على حالة الإكمال حتى يضغط المستخدم على "إعادة الضبط"
                }
            }
            updateZahraUI();
        }

        // إعادة ضبط العداد
        function resetZahraCounter(showConfetti = true) {
            zahraState = {
                currentPhraseIndex: 0,
                allahuAkbar: 0,
                alhamdulillah: 0,
                subhanallah: 0
            };
            updateZahraUI();
            if (showConfetti) {
                // إظهار رسالة قصيرة أو اهتزاز
            }
        }
        
        // تحميل حالة العداد عند بدء التشغيل
        function loadTasbeehState() {
            const savedState = localStorage.getItem('tasbeehState');
            if (savedState) {
                try {
                    const parsedState = JSON.parse(savedState);
                    // التحقق من سلامة البيانات المحفوظة
                    if (parsedState.allahuAkbar !== undefined) {
                        zahraState = parsedState;
                    }
                } catch (e) {
                    console.error("Failed to parse tasbeeh state", e);
                }
            }
            updateZahraUI();
        }

        // ======= 7. منطق التسبيحة المفتوحة (Open Tasbeeh) =======
        let openTasbeehState = {
            count: 0,
            phrase: 'ذكر' // تحديد قيمة افتراضية للعبارة
        };

        function updateOpenUI() {
            document.getElementById('tasbeeh-open-counter').textContent = openTasbeehState.count;
            document.getElementById('tasbeeh-open-phrase').textContent = openTasbeehState.phrase;
            // حفظ الحالة
            localStorage.setItem('openTasbeehState', JSON.stringify(openTasbeehState));
        }

        function incrementOpenCounter() {
            openTasbeehState.count++;
            // إخفاء رسالة الإكمال إن كانت ظاهرة
            document.getElementById('open-completion-message').classList.add('hidden');
            updateOpenUI();
        }

        function resetOpenCounter(showMessage = true) {
            openTasbeehState.count = 0;
            updateOpenUI();
            if (showMessage) {
                const el = document.getElementById('open-completion-message');
                el.classList.remove('hidden');
                setTimeout(() => el.classList.add('hidden'), 1500);
            }
        }

        function loadOpenTasbeehState() {
            const saved = localStorage.getItem('openTasbeehState');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    if (typeof parsed.count === 'number') {
                        openTasbeehState = parsed;
                    }
                } catch (e) {
                    console.error('Failed to parse open tasbeeh state', e);
                }
            }
            updateOpenUI();
        }

        // تشغيل الدوال الأساسية عند تحميل الصفحة
        window.onload = function() {
            applySavedSettings();
            setupCollapsibles();
            loadTasbeehState();
            loadOpenTasbeehState();
        };

    </script>
</body>
</html>